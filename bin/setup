#!/bin/bash

cartridge_type="python-2.7"
source "/etc/openshift/node.conf"


# Import Environment Variables
for f in ~/.env/*; do
    source $f
done

# RR: For testing
exit 0

source "${OPENSHIFT_HOMEDIR}/${cartridge_type}/lib/utils"

pod_cart_name=$(get_pod_cartridge_name)

#  Extract the tarball files -- supports .tar, .tar.gz, .tar.gz and zip files.
extract_package_files "${OPENSHIFT_HOMEDIR}/$pod_cart_name/$cartridge_type/opt"

#  Add the python cartridge environment variables.
add_cartridge_env_var "PYTHON_EGG_CACHE" "${OPENSHIFT_HOMEDIR}/$cartridge_type/virtenv/.python-eggs"

#  Create the virtualenv.
create_virtualenv

#  Write a file that can be sourced for setting the LD_LIBRARY_PATH and
#  activating the virtualenv on the shell.
cat > "${OPENSHIFT_HOMEDIR}/$cartridge_type/activate_virtenv"  <<AVEOF
#  Set the library path so that the python 2.7 shared library can be found.
export LD_LIBRARY_PATH="${OPENSHIFT_HOMEDIR}/$cartridge_type/opt/lib:\${LD_LIBRARY_PATH}" 
source ${OPENSHIFT_HOMEDIR}/$cartridge_type/virtenv/bin/activate
AVEOF

chmod 555 "${OPENSHIFT_HOMEDIR}/$cartridge_type/activate_virtenv"

